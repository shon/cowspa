{% extends "members/profile_layout.html" %}

{% block content %}

<script>
    
    function addMore() { 
        var extra_div_element = document.getElementById('extra_div');
        aTextBox = document.createElement('input');
        var inputidname = 'socialnw_choice_'+ socialnw_count;
        aTextBox.setAttribute('id', inputidname);
        aTextBox.setAttribute('class', 'socialnw-input');
        aTextBox.setAttribute('type','text');
        extra_div_element.appendChild(aTextBox); 
        var extra_select_element = document.getElementById('social_nw_div_select');
        var clone = extra_select_element.clone().inject(inputidname,'after');
        socialnw_count = socialnw_count + 1;
    };

    function hideeditpage(){
        $('myprofileedit').set('class', 'hidediv');
        $('myprofilediv').set('class', 'showdiv');
        $('socialmediv').set('class', 'showdiv');
    };

    function showeditpage(){
        $('myprofileedit').set('class', 'showdiv');
        $('myprofilediv').set('class', 'hidediv');
        $('socialmediv').set('class', 'hidediv');
    };

    socialnw_count = 0;
</script>

#myprofilediv.showdiv 
    .pl2.pr2.pb2.dp50.rc.box-shadow
        h3.mt1.member-name
            c.data-display_name | Loading...
            span.edit-link
                a href=#myprofileedit onclick=showeditpage() | Edit
        > hr
        > div.data-long_description
        > hr
        .p1
            .dp50.leftcol | Interests in
            #interests.dp50.rightcol | Networking, Collaboration
        .p1
            .dp50.leftcol | Expertise
            #expertise.dp50.rightcol | Python Developer

{% include 'socialme.html' %}

#myprofileedit.hidediv
    div.pl2.pr2.dp80.rc.box-shadow
        h3.mt1 | Edit Profile
        > hr
        form#myprofileeditform
            table
                tr
                    > td
                    > td
                    th.rightcol-makepublic
                        c | Make it Public?
                tr
                    td.leftcol-sp | First Name
                    td.middlecol-sp
                        > input.text.data-first_name name=first_name type=text placeholder=First name
                    > td

                tr
                    td.leftcol-sp | Last Name
                    td.middlecol-sp
                        > input.text.data-last_name name=first_name type=text placeholder=Last name
                    > td

                tr
                    td.leftcol-sp | Short Description
                    td.middlecol-sp
                        > input.text.data-last_name name=short_description type=text placeholder=One line summary about you
                    td.rightcol-makepublic
                        > input#public_field name="public_field" value=1 title="Make it public?" type=checkbox

                tr
                    td.leftcol-sp | Long Description
                    td.middlecol-sp
                        > input.text.data-last_name name=short_description type=text
                    td.rightcol-makepublic
                        > input#public_field name="public_field" value=1 title="Make it public?" type=checkbox

                tr
                    td.leftcol-sp | Upload photo
                    td.middlecol-sp
                        > input#uploadPicture.textbox type="file"
                    td.rightcol-makepublic
                        > input#public_field name="public_field" value=1 title="Make it public?" type=checkbox

                tr
                    > td
                    td.specific.pb3
                        em | Do not upload photos containing cartoons, celebrities, nudity, artwork or copyrighted images.

                tr
                    td.leftcol-sp | Website
                    td.middlecol-sp
                        > input#website.text type=url name=website placeholder=http://
                    td.rightcol-makepublic
                        > input#public_field name="public_field" value=1 title="Make it public?" type=checkbox

                tr
                    td.leftcol-sp | Interests in
                    td.middlecol-sp
                        > input#interests.text type=text name=interests placeholder="Fields you are interested in"
                    td.rightcol-makepublic
                        > input#public_field name="public_field" value=1 title="Make it public?" type=checkbox

                tr
                    td.leftcol-sp | Expertise in
                    td.middlecol-sp
                        > input#expertise.text type=text name=expertise placeholder=Your expertise
                    td.rightcol-makepublic
                        > input#public_field name="public_field" value=1 title="Make it public?" type=checkbox

                tr
                    td.leftcol-sp | Social me
                    td.middlecol
                       #social_nw_div
                           > input.socialnw-input name=socialnw_choice_0 class=socialnw-input type=text
                           select#social_nw_div_select.social-select name=socialnw_options[]
                              option value=1 | Twitter
                              option value=2 | Facebook
                              option value=3 | LinkedIn
                              option value=4 | Google Profile
                              option value=5 | Flickr
                              option value=6 | Skype

                tr
                    > td.leftcol-sp
                    td.middlecol
                        > div#extra_div

                tr
                    > td.leftcol-sp
                    td
                        div
                            a href=javascript:; onclick=addMore(); | Add more

            > hr
            .middlecol
                button#submit_myprofileedit | Update
                button#reset | Reset
                button#cancel onclick=hideeditpage() | Cancel
            > hr

<script>
function show_loading() {
    var fields = [
        '.data-first_name',
        '.data-last_name'
    ];
    for (var i in fields) {
        $$(fields[i]).set('value', 'loading ...');
    };
    var fields = [
        '.data-long_description'
    ];
    for (var i in fields) {
        $$(fields[i]).set('text', 'loading ....');
    };

};
function hide_loading() {};
function load_data(data) {
    var first_name = data['profile']['first_name'];
    var last_name = data['profile']['last_name'];
    var display_name = first_name + ' ' + last_name;
    $$('.data-display_name').set('text', display_name);
    $$('.data-first_name').set('value', first_name);
    $$('.data-last_name').set('value', last_name);
    var long_description = data['profile']['long_description'];
    $$('.data-long_description').set('html', long_description);
    $('long_description').set('text', long_description);
    var long_description_editor = new MooEditable('long_description', {
        actions: 'bold italic underline strikethrough | formatBlock justifyleft justifyright justifycenter justifyfull | smiley urlimage | insertunorderedlist insertorderedlist indent outdent insertHorizontalRule | undo redo removeformat | createlink unlink | urlimage | toggleview' });
    long_description_editor.setContent(long_description);
};

var req = new JSONRequest({
    url: "/api/0.1/mydetails",
    onRequest: show_loading,
    onComplete: hide_loading,
    on_success: load_data
});
req.json_send();

</script>

{% endblock %}
